<html>
  <head>
    <link rel="stylesheet" href="../Loader/css/spectre.min.css">
  </head>
  <body>

    <p>Device Name: <input type="text" id="devname" class="form-input" value="eucWatch"></p>
	<p>Touch controler type: <select type="text" id="touchtype" value="716" class="form-select"><option>716</option><option>816</option><option>816s</option></select></p>
	<p>Accelerator type: <select type="text" id="acctype" value=localStorage.p8acc class="form-select"><option>BMA421</option><option>SC7A20</option></select></p>
    <p><button id="set" class="btn btn-primary">Set</button></p>
	<h6>This will change drivers and restart the watch</h6>
	<h7>Select an accelerator and touch controller that works with your watch variant.</h7>
    <script src="../Loader/core/js/comms.js"></script>
	<script src="https://www.puck-js.com/puck.js"></script>
    <script>
		function selectElement(id, valueToSelect) {    
			let element = document.getElementById(id);
			element.value = valueToSelect;
		}
		selectElement('acctype', localStorage.p8acc);
		selectElement('touchtype', localStorage.p8touch);
		selectElement('devname', localStorage.p8name);
      // When the 'upload' button is clicked...
      document.getElementById("set").addEventListener("click", function() {

        // get the text to add
        var acc = document.getElementById("acctype").value;
        var touch = document.getElementById("touchtype").value;
		var name = document.getElementById("devname").value;

        if (acc!="BMA421"&&acc!="SC7A20") {
          alert("Accelerator type needs to be BMA421 or SC7A20");
          return;
        }
		if (touch!="816"&&touch!="716"&&touch!="816s") {
          alert("Touch controler type needs to be 716 or 816 or 816s");
          return;
        }
		Comms.changeSettings('setting','acctype',acc).then(function() {
		Comms.changeSettings('setting','touchtype',touch)
		}).then(function() {
		Comms.changeSettings('setting','name', name)
		}).then(function() {
		Comms.reset()
		return;
		});
		window.postMessage();
      });

    </script>
  </body>
</html>